import { svgPathToCssPolygon } from "./helpers/svgPathToCssPolygon";
import { getPathAndViewbox } from './helpers/getPathAndViewbox'
import { makePathRelative } from "./helpers/makePathRelative";

const testSvg = '<svg width="300" height="207" viewBox="0 0 300 207" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M15.2685 10.2592C16.0884 9.8505 17.8465 9.36863 20.6201 8.86695C23.3348 8.37594 26.8643 7.89146 31.1037 7.42009C39.5791 6.47771 50.8171 5.59579 63.8951 4.81524C90.0469 3.25438 123.496 2.1024 156.791 1.67821C190.089 1.25397 223.206 1.55802 248.703 2.90585C261.456 3.58005 272.266 4.51368 280.227 5.74056C284.211 6.35466 287.436 7.03555 289.817 7.77832C291.007 8.14972 291.95 8.5256 292.657 8.89716C293.377 9.27572 293.754 9.59936 293.925 9.82165C294.283 10.2993 294.736 11.3831 295.192 13.2458C295.633 15.0508 296.037 17.4035 296.399 20.2458C297.121 25.9262 297.657 33.4441 298.007 42.2044C298.707 59.7182 298.658 82.0941 297.883 104.448C297.107 126.805 295.606 149.103 293.41 166.467C292.31 175.155 291.042 182.567 289.615 188.12C288.9 190.899 288.157 193.172 287.393 194.89C286.609 196.654 285.882 197.649 285.302 198.086C285.034 198.287 284.525 198.552 283.688 198.847C282.871 199.135 281.826 199.423 280.552 199.707C278.006 200.276 274.644 200.808 270.562 201.3C262.403 202.283 251.485 203.093 238.711 203.73C213.171 205.004 180.309 205.582 147.479 205.491C114.65 205.399 81.8767 204.638 56.5156 203.235C43.8316 202.534 33.0253 201.673 25.0013 200.66C20.9862 200.152 17.6984 199.61 15.2329 199.039C13.9995 198.753 12.9986 198.465 12.228 198.181C11.4337 197.888 10.9871 197.635 10.7781 197.463C10.0922 196.895 9.31643 195.755 8.52998 193.889C7.75822 192.059 7.03671 189.679 6.37445 186.799C5.05064 181.044 3.99875 173.452 3.21645 164.613C1.65272 146.947 1.17982 124.467 1.70649 102.105C2.23318 79.7425 3.75838 57.5487 6.17853 40.4531C7.38956 31.8986 8.81793 24.6705 10.4401 19.3515C11.2519 16.6893 12.0971 14.5568 12.9602 12.9914C13.8455 11.3856 14.6455 10.5697 15.2685 10.2592Z" stroke="#D5DB53" stroke-width="3"/></svg>'

const previewPolygon = document.getElementById("preview_polygon");
const secondTitle = document.querySelector(".main_title--second");
const svgInHtml = document.getElementById("my-clip-path");

{/* <svg class="shapes">
<clipPath id="my-clip-path" clipPathUnits="objectBoundingBox">
  <path
    d="M 0.051 0.05C 0.054 0.048 0.059 0.045 0.069 0.043C 0.078 0.04 0.09 0.038 0.104 0.036C 0.132 0.031 0.169 0.027 0.213 0.023C 0.3 
    0.016 0.412 0.01 0.523 0.008C 0.634 0.006 0.744 0.008 0.829 0.014C 0.872 0.017 0.908 0.022 0.934 0.028C 0.947 0.031 0.958 0.034 0.966 0.038C 0.97 0.039 0.973 0.041 0.976 0.043C 0.978 0.045 0.979 0.046 0.98 0.047C 0.981 0.05 0.982 0.055 0.984 0.064C 0.985 0.073 0.987 0.084 0.988 0.098C 0.99 0.125 0.992 0.162 0.993 0.204C 0.996 0.288 0.996 0.397 0.993 0.505C 0.99 0.613 0.985 0.72 
    0.978 0.804C 0.974 0.846 0.97 0.882 0.965 0.909C 0.963 0.922 0.961 0.933 0.958 0.941C 0.955 0.95 0.953 0.955 0.951 0.957C 0.95 
    0.958 0.948 0.959 0.946 0.961C 0.943 0.962 0.939 0.963 0.935 0.965C 0.927 0.968 0.915 0.97 0.902 0.972C 0.875 0.977 0.838 0.981 0.796 0.984C 0.711 0.99 0.601 0.993 0.492 0.993C 0.382 0.992 0.273 0.989 0.188 0.982C 0.146 0.978 0.11 0.974 0.083 0.969C 0.07 0.967 0.059 0.964 0.051 0.962C 0.047 0.96 0.043 0.959 0.041 0.957C 0.038 0.956 0.037 0.955 0.036 0.954C 0.034 0.951 0.031 0.946 0.028 0.937C 0.026 0.928 0.023 0.916 0.021 0.902C 0.017 0.875 0.013 0.838 0.011 0.795C 0.006 0.71 0.004 0.601 0.006 0.493C 0.007 0.385 0.013 0.278 0.021 0.195C 0.025 0.154 0.029 0.119 0.035 0.093C 0.038 0.081 0.04 0.07 0.043 0.063C 0.046 0.055 0.049 0.051 0.051 0.05Z"
  ></path>
</clipPath>
</svg> */}

const handleSubmit = (e) => {
    e.preventDefault()
    const formData = new FormData(e.target);
    const svgFromForm = formData.get("svg");

    const svgPathAndViewbox = getPathAndViewbox(svgFromForm);

    const cssPolygon = svgPathToCssPolygon(svgPathAndViewbox);
    const relativePath = makePathRelative(svgPathAndViewbox);

    previewPolygon.style.clipPath = `${cssPolygon}`
    secondTitle.scrollIntoView({behavior: "smooth"});

    const pathForSvgInHtml = document.createElementNS("http://www.w3.org/2000/svg", 'path');
    pathForSvgInHtml.setAttribute('d', relativePath);
    svgInHtml.innerHTML = "";
    svgInHtml.appendChild(pathForSvgInHtml);
   

    console.log(relativePath);
}

window.onload = function() {
    const form = document.querySelector("form");
    form.onsubmit = handleSubmit;
}